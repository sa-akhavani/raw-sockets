import unittest
import httpcode


class HTTPTest(unittest.TestCase):
    def testextractheaders(self):
        slz = bytearray(b'HTTP/1.1 200 OK\r\nDate: Fri, 20 Nov 2020 01:28:45 GMT\r\nServer: Apache\r\nLast-Modified: Wed, 23 Jul 2014 14:59:23 GMT\r\nAccept-Ranges: bytes\r\nContent-Length: 2097152\r\nVary: Accept-Encoding,User-Agent\r\nContent-Type: text/x-log\r\n\r\n\xe7Y\x03\\!\xe1\xc2\xc0m\x9dg\xfd\x11\x01b\xb1#\x8a\xee\x9e2w\xd4H\x91\x91\xdc\x8dM\xca\xe4\xb7\xb0`\x83\x13\xb2\xee\x89}\xdf\x06\xbc>\xe3O\xbe\xb3\xaeP\x18\xeb\x14\xe3og\xacY\x99\xaa\x8e\xbe\x8f\x0f2\xd0\x86\xb33T\xc2\xbf\xc3@\xb8\xa2\xd1\x89X\x9dx\x8f\xeb\x1da,\xc0"\xa8 \xd3\xdap\x1d/\xacJeR\x1f_S4\xb4p^a%\xdfOWz\xe4~\xab\xf6&\xa9\xe93\x02\x06\x88\xb8\xa9\xf52\x0elX\xee\xcd\xf2\x83\x8d4\x05X\xe0\x7f\xae\xde\x88\x15\x9a\xbfH\xff\xaa\xf8A\x12S\xfe\x92\x81\xa3\x84\xd31\xc5R\x89\n \xa8\xb3b\xc0\x82\x93\x15i\xca\\_s\x80t\\/?\x1aa\x16c\x94\xcc*\xd0\x80\xdc\x99\x01\x96_\xcb\xa7\xb1\xbf\xb1\x14\x98l\x9e\x8e\x960\x9a\x86\xc8\xb7pe\xa5T\x85\xef\x0c\x89\xd7\xf1\xb8\x1e,\\9ls\xc4l\xbb\r\xfc\x99\x84\'\x8b\xb0\x81\xf4\xde\x9c\xcb#\xd5\xb8\xa0{o!.\x9f\xd1\x1e\xe8\x8b\x1aa\x04\xbe\xa0\'\xc4\x10n\xf8\x06wT(R\xb4\xcfi:\xad\xb5\xfe\xc0\xfbR\x018\x03\xa2\xb3\xb0\xaf$\xdb\n\x1b\xd2\xde]\x97q]OV3\x98w9\x9d\x96#\xd3\x9e\xfd\x1f\xc0\xd9\xdei\xa8C\xa3\x95(\xc6\x8e\xfa\x11$o\x00\x1aI\x03Z\x02\x00)s\xad\xb3>\xe4\xa9YK\xda\xa4\xdd\x0bm\x892\xa6\xc4\'\xc2\x99\xcb\xb6\xc3\x98!\x8dh\xa7\xcf;o\x0c\xd0\xe2O\x0c\xbd\xae\xdf?\xb49q\x85\x1a/\xfb\xad\x88\xd4\x18\xe7\xcah\x01\n\xd0\xb6\ttx,\xbe\x98ax\x15@\xf8\x02\\E\xf6\xc9r\x91G\x8e\x92T\xa9\x0etvt\x10\xfal\x9e!\x83\x1a!=i\x18\x15\x00\xcbQ\xb7L/W\xe0c\x1e\x97\xe3\x03\x90\xc5J\xaaV\x1c\xe7\xc6\xdc\xe0\x02\x10T\xb0tL&dwM\xfc\x9d2\x19\xfb\xc1/')
        httpobj = httpcode.HTTPResponse(slz)

        slzstr = slz.decode('utf-8', 'replace')
        lines = slzstr.split('\r\n')

        bodyline, bodybyte = httpobj.extractheaders(lines)

        self.assertEqual(bodyline, 9)
        self.assertEqual(bodybyte, 225)


if __name__ == '__main__':
    unittest.main()
